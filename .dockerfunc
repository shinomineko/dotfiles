#!/bin/zsh

rm_stopped() {
  local name="$1"
  local state
  state=$(docker inspect -f "{{.State.Running}}" "$name" 2>/dev/null)
  if [[ "$state" == "false" ]]; then
    docker rm "$name"
  fi
}

trivy() {
  docker run --rm \
    --name trivy \
    -v /var/run/docker.sock:/var/run/docker.sock \
    -v "${HOME}/.cache:/root/.cache" \
    aquasec/trivy "$@"
}

torproxy() {
  rm_stopped torproxy
  docker run -d \
    --restart always \
    --name torproxy \
    -v /etc/localtime:/etc/localtime:ro \
    -p 9050:9050 \
    shinomineko/torproxy
}
